/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package jmetrics;
/**
 *
 * @author ioannis
 */

import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.logging.Level;
import java.util.logging.Logger;
import org.eclipse.jdt.astview.*;

public class ASTViewStrategy implements Strategy{
    
  private TreeInfoCollector treeInfo;
  public int noOfASTNodes = 0;

  public void countNoOfASTNodes(String dir) throws IOException{
    ASTViewStrategy astview = new ASTViewStrategy();
    File root = new File(dir);
    astview.noOfNodes(root);
    System.out.println("No of Nodes"+ noOfASTNodes);
  }
  
  private void noOfNodes(File dir) throws IOException{
      
        for (File f : dir.listFiles()){
        if (f.isDirectory()){
        treeInfo = TreeInfoCollector.NodeCounter.class.(f);
        noOfNodes(f);
        }
        else{
        if(f.getName().endsWith(".java")){
        noOfASTNodes = treeInfo.getSize();
                }
            }
        }
    }
    
    @Override
    public void analyse(String dir){
    try{
        countNoOfASTNodes(dir);
    } catch (IOException ex){
        Logger.getLogger(ASTViewStrategy.class.getName()).log(Level.SEVERE,null, ex);
    }
    }
  }
    
  
    

